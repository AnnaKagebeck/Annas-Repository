using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Text.RegularExpressions;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Default : System.Web.UI.Page 
{
    protected void Page_Load(object sender, EventArgs e)
    {
        List<string> wineDistrictList;
        wineDistrictList = new List<string> {"Bordeaux", "Rioja", "Chablis", "Chianti"};

        Repeater1.DataSource = wineDistrictList;
        Repeater1.DataBind();


        
    }

    private List<string> GetPhoneNumber( string[] tfnString )
    {
        List<string> resultString = new List<string>();        

        try
        {
            foreach (string s in tfnString)
                resultString.Add(Regex.Replace(s, @"^(0(?:271|322|174|472|371|589|961|960|570|583|226|624|915|531|652|932|662|921|278|243|33|142|661|456|693|914|912|431|571|295|586|552|653|942|534|271|381|471|171|246|16|413|223|346|515|23|590|122|585|157|241|943|684|258|528|645|241|493|371|158|498|525|555|591|390|514|551|672|970|693|26|31|511|563|975|643|582|220|175|35|696|644|297|922|928|224|684|225|291|42|513|301|503|290|671|506|650|495|36|663|345|591|611|451|42|491|415|413|253|247|971|621|647|36|916|923|480|505|454|294|586|455|54|150|554|320|980|494|435|580|977|612|44|550|640|226|19|300|227|303|221|430|925|418|584|247|474|302|478|692|510|581|13|642|372|651|657|240|920|46|950|523|913|157|40|280|953|496|159|501|433|530|142|553|250|141|392|524|563|499|587|223|930|11|176|918|512|481|155|380|622|297|454|250|304|479|491|643|155|978|435|911|973|623|175|934|457|459|472|924|682|248|224|26|414|416|511|910|222|142|294|500|240|620|952|8|951|290|152|433|526|670|695|60|565|220|418|585|680|325|687|246|564|533|253|225|382|293|270|121|456|504|502|293|60|477|304|417|691|560|16|486|345|325|140|410|520|156|954|292|506|522|613|321|90|18|143|393|156|123|281|512|340|383|125|940|492|933|151|495|498|981|976|322|521|935|370|490|21|470|411|571|532|690|647|573|474|941|120|476|251|929|431|144|485|295|19|173|660|291|63|292|173|926|927))(\d{2,3})(\d{2,3})(\d{2,3}|)$",
                //resultString.Add(Regex.Replace(s, @"^(0(?:271|322|174|472|371|589|961|960|570|583|226|624|915|531|652|932|662|921|278|243|33|142|661|456|693|914|912|431|571|295|586|552|653|942|534|271|381|471|171|246|16|413|223|346|515|23|590|122|585|157|241|943|684|258|528|645|241|493|371|158|498|525|555|591|390|514|551|672|970|693|26|31|511|563|975|643|582|220|175|35|696|644|297|922|928|224|684|225|291|42|513|301|503|290|671|506|650|495|36|663|345|591|611|451|42|491|415|413|253|247|971|621|647|36|916|923|480|505|454|294|586|455|54|150|554|320|980|494|435|580|977|612|44|550|640|226|19|300|227|303|221|430|925|418|584|247|474|302|478|692|510|581|13|642|372|651|657|240|920|46|950|523|913|157|40|280|953|496|159|501|433|530|142|553|250|141|392|524|563|499|587|223|930|11|176|918|512|481|155|380|622|297|454|250|304|479|491|643|155|978|435|911|973|623|175|934|457|459|472|924|682|248|224|26|414|416|511|910|222|142|294|500|240|620|952|8|951|290|152|433|526|670|695|60|565|220|418|585|680|325|687|246|564|533|253|225|382|293|270|121|456|504|502|293|60|477|304|417|691|560|16|486|345|325|140|410|520|156|954|292|506|522|613|321|90|18|143|393|156|123|281|512|340|383|125|940|492|933|151|495|498|981|976|322|521|935|370|490|21|470|411|571|532|690|647|573|474|941|120|476|251|929|431|144|485|295|19|173|660|291|63|292|173|926|927))(\d{2})(\d{2,3})(\d{2,3}|)$",
                                               "$1-$2 $3 $4"));
        } catch (ArgumentException ex) 
        {
	        // Syntax error in the regular expression
        }
        return resultString;
    }

    private List<string> GetPhoneNumber2(string[] tfnString)
    {
        List<string> resultString = new List<string>();

        try
        {
            //foreach (string s in tfnString)
            //    resultString.Add(Regex.Replace(s,
            //                                   @" ^(0(?:271|322|174|472|371)) (\d{2}) (\d{2,3}) (\d{2,3}|) $",
            //                                   "$1"));
            string areaCode = string.Empty;
            string phoneNumber = string.Empty;
            string formattedNumber = string.Empty;
            string number = string.Empty;

            foreach (string s in tfnString)
            {
                //resultString.Add(Regex.Replace(s, @"^(0(?:271|322|174|472|371|589|961|960|570|583|226|624|915|531|652|932|662|921|278|243|33|142|661|456|693|914|912|431|571|295|586|552|653|942|534|271|381|471|171|246|16|413|223|346|515|23|590|122|585|157|241|943|684|258|528|645|241|493|371|158|498|525|555|591|390|514|551|672|970|693|26|31|511|563|975|643|582|220|175|35|696|644|297|922|928|224|684|225|291|42|513|301|503|290|671|506|650|495|36|663|345|591|611|451|42|491|415|413|253|247|971|621|647|36|916|923|480|505|454|294|586|455|54|150|554|320|980|494|435|580|977|612|44|550|640|226|19|300|227|303|221|430|925|418|584|247|474|302|478|692|510|581|13|642|372|651|657|240|920|46|950|523|913|157|40|280|953|496|159|501|433|530|142|553|250|141|392|524|563|499|587|223|930|11|176|918|512|481|155|380|622|297|454|250|304|479|491|643|155|978|435|911|973|623|175|934|457|459|472|924|682|248|224|26|414|416|511|910|222|142|294|500|240|620|952|8|951|290|152|433|526|670|695|60|565|220|418|585|680|325|687|246|564|533|253|225|382|293|270|121|456|504|502|293|60|477|304|417|691|560|16|486|345|325|140|410|520|156|954|292|506|522|613|321|90|18|143|393|156|123|281|512|340|383|125|940|492|933|151|495|498|981|976|322|521|935|370|490|21|470|411|571|532|690|647|573|474|941|120|476|251|929|431|144|485|295|19|173|660|291|63|292|173|926|927))(\d{2,3})(\d{2,3})(\d{2,3}|)$",
                //areaCode = Regex.Replace(s,
                //                                @"^(0(?:271|322|174|472|371|589|961|960|570|583|226|624|915|531|652|932|662|921|278|243|33|142|661|456|693|914|912|431|571|295|586|552|653|942|534|271|381|471|171|246|16|413|223|346|515|23|590|122|585|157|241|943|684|258|528|645|241|493|371|158|498|525|555|591|390|514|551|672|970|693|26|31|511|563|975|643|582|220|175|35|696|644|297|922|928|224|684|225|291|42|513|301|503|290|671|506|650|495|36|663|345|591|611|451|42|491|415|413|253|247|971|621|647|36|916|923|480|505|454|294|586|455|54|150|554|320|980|494|435|580|977|612|44|550|640|226|19|300|227|303|221|430|925|418|584|247|474|302|478|692|510|581|13|642|372|651|657|240|920|46|950|523|913|157|40|280|953|496|159|501|433|530|142|553|250|141|392|524|563|499|587|223|930|11|176|918|512|481|155|380|622|297|454|250|304|479|491|643|155|978|435|911|973|623|175|934|457|459|472|924|682|248|224|26|414|416|511|910|222|142|294|500|240|620|952|8|951|290|152|433|526|670|695|60|565|220|418|585|680|325|687|246|564|533|253|225|382|293|270|121|456|504|502|293|60|477|304|417|691|560|16|486|345|325|140|410|520|156|954|292|506|522|613|321|90|18|143|393|156|123|281|512|340|383|125|940|492|933|151|495|498|981|976|322|521|935|370|490|21|470|411|571|532|690|647|573|474|941|120|476|251|929|431|144|485|295|19|173|660|291|63|292|173|926|927))(\d+|)$",
                //                                "$1-$2");
                phoneNumber = Regex.Replace(s,
                                            @"^(0(?:11|120|121|122|123|125|13|140|141|142|143|144|150|151|152|155|156|157|158|159|16|171|173|174|175|176|18|19|21|220|221|222|223|224|225|226|227|23|240|241|243|246|247|248|250|251|253|258|26|270|271|278|280|281|290|291|292|293|294|295|297|300|301|302|303|304|31|320|321|322|325|33|340|345|346|35|36|370|371|372|380|381|382|383|390|392|393|40|410|411|413|414|415|416|417|418|42|430|431|433|435|44|451|454|455|456|457|459|46|470|471|472|474|476|477|478|479|480|481|485|486|490|491|492|493|494|495|496|498|499|500|501|502|503|504|505|506|510|511|512|513|514|515|520|521|522|523|524|525|526|528|530|531|532|533|534|54|550|551|552|553|554|555|560|563|564|565|570|571|573|580|581|582|583|584|585|586|587|589|590|591|60|611|612|613|620|621|622|623|624|63|640|642|643|644|645|647|650|651|652|653|657|660|661|662|663|670|671|672|680|682|684|687|690|691|692|693|695|696|8|90|910|911|912|913|914|915|916|918|920|921|922|923|924|925|926|927|928|929|930|932|933|934|935|940|941|942|943|950|951|952|953|954|960|961|970|971|973|975|976|977|978|980|981|))(\d+|)$",
                                            "$1-$2");
                //phoneNumber = areaCode;

                var numb = phoneNumber.Split('-');

                if (numb[0].Length == 1)
                    phoneNumber = s;
                else
                {
                    switch (numb[1].Length)
                    {
                        case 5: // xxx-xxx xx                        
                            phoneNumber = String.Format("{0}-{1} {2}", numb[0], numb[1].Substring(0, 3),
                                                        numb[1].Substring(3, 2));
                            break;
                        case 6: // xxx-xx xx xx
                            phoneNumber = String.Format("{0}-{1} {2} {3}", numb[0], numb[1].Substring(0, 2),
                                                        numb[1].Substring(2, 2), numb[1].Substring(4, 2));
                            break;
                        case 7: // xxx-xxx xx xx
                            phoneNumber = String.Format("{0}-{1} {2} {3}", numb[0], numb[1].Substring(0, 3),
                                                        numb[1].Substring(3, 2), numb[1].Substring(5, 2));
                            break;
                        case 8: // xxx-xxx xxx xx
                            phoneNumber = String.Format("{0}-{1} {2} {3}", numb[0], numb[1].Substring(0, 3),
                                                        numb[1].Substring(3, 3), numb[1].Substring(5, 2));
                            break;
                    }
                }




                // 5 digits => xxx xx

                // 6 digits => xx xx xx
                // 7 digits => xxx xx xx
                // 8 digits => xxx xxx xx
                //
                resultString.Add(phoneNumber);
            }
        }
        catch (ArgumentException ex)
        {
            // Syntax error in the regular expression
        }
        return resultString;
    }
                    




    protected void TfnNumberBtn_Click(object sender, EventArgs e)
    {
        var tfnNumbers = new[] { "03112345", "031123456", "05321234567", "053212345678", "0124343434", "019123456785454" };
                       
        Repeater2.DataSource = GetPhoneNumber2(tfnNumbers);
        Repeater2.DataBind();

    }
}
